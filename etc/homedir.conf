
# Homedir
# ------------------------------------------------------------------ #

# NOTE: Configuration of special remotes:
#
#   1. init by hand on one of the machines, like this
#       git annex initremote "type=S3" "fileprefix=$subdir/" "bucket=$bucket" "encryption=hybrid" "embedcreds=yes" "partsize=1GiB" "datacenter=EU"       
#
#   2. when initializing on each machine, copy the uuid. Can't chose the uuid's a priori.

lib =
    # Load homedir related functions
    source "$HOME/.mr/lib/mr.sh"
    source "$HOME/.mr/lib/git.sh"
    source "$HOME/.mr/lib/git-annex.sh"
    source "$HOME/.mr/lib/unison.sh"
    source "$HOME/.mr/lib/homedir.sh"


[bin]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quark" "quasar" "skynet"

init =
        # config
        homedir_perms "700"


[arch]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        # remotes
        homedir_remote 'uni' 'ada'           'a58c4a17-1b6f-4907-9a32-803465f05aba'  '/media/ada/home/abdo/arch'
        homedir_remote 'uni' 'galois'        '823885ab-6862-415f-99c8-7140972d61cd'  '/home/abdo/arch'
        homedir_remote 'uni' 'grothendieck'  '7424a886-e8b0-4e0b-b946-cae7ed00bf77'  '/home/abdo/arch'
        homedir_remote 'uni' 'quasar'        '5c543df5-e751-4a25-aa77-bcc12e66cd30'  '/media/quasar/abdo/arch'
        homedir_remote 'uni' 'skynet'        '9a233f64-094f-4149-9236-00b64ffd0157'  '/data/abdo/arch'
        # unison        
        unison_config "$MR_REPO" 'mountpoint' 'config'


[build]
checkout = homedir_checkout "ada" "galois" "grothendieck" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "dir"
        mkdir -p "$MR_REPO/arch" "$MR_REPO/bibrain" "$MR_REPO/sage"
        # remotes
        homedir_remote 'dir' 'ada'           '41bbfab9-b5f1-443f-9a39-1011afe02c1b'  '/media/ada/home/abdo/build'
        homedir_remote 'dir' 'galois'        '4108ac40-fb45-4e97-a32d-1a19f960d176'  '/home/abdo/build'
        homedir_remote 'dir' 'grothendieck'  'a9a68175-1ab6-46d7-9398-67d50553e3d9'  '/data/abdo/build'
        homedir_remote 'dir' 'skynet'        '44c6c363-c244-434a-bc7b-d5d89142259f'  '/data/abdo/build'
        # annex
        homedir_init "annex"         
        git_config "$MR_REPO"  "annex.largefiles"    "exclude=*"


[devel]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"        
        # remotes
        homedir_remote 'uni' 'ada'           '19c6ea45-5b83-4273-ba45-13bd045c39a4'  '/media/ada/home/abdo/devel'
        homedir_remote 'uni' 'galois'        'f97bff76-dd93-4ea1-80b3-7f1df9e2952d'  '/home/abdo/devel'
        homedir_remote 'uni' 'grothendieck'  '97b6c1b4-90b2-48a3-9fc2-cf204e7794ee'  '/home/abdo/devel'
        homedir_remote 'uni' 'quasar'        '35db1707-6cff-4646-baa2-881d1b85d6da'  '/media/quasar/abdo/devel'
        homedir_remote 'uni' 'skynet'        'fb73b3c0-cf12-468e-9721-6fd9bd5c5550'  '/data/abdo/devel'
        # unison        
        unison_config "$MR_REPO" 'mountpoint' 'core'


[docs]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"
       
init =
        # config
        homedir_perms "700"
        homedir_init "git" 
        # remotes
        homedir_remote 'git' 'ada'           'ca1fda73-436a-417c-ac12-22c3fd4d859b'  '/media/ada/home/abdo/docs'
        homedir_remote 's3'  'babel'         '422b5b04-100c-4515-b437-445eaa2afb8b'  'docs'
        homedir_remote 'git' 'galois'        '348fb798-7efc-4420-9809-8c9ae85c0ae0'  '/home/abdo/docs'
        homedir_remote 'git' 'grothendieck'  '66331ac4-27b1-4526-b88d-0cad1a498018'  '/home/abdo/docs'
        homedir_remote 'git' 'quasar'        '2c0708a6-c80f-4ffb-bf27-5faecdda2491'  '/media/quasar/abdo/docs'
        homedir_remote 'git' 'skynet'        'ba0ea118-7d61-43ce-83ae-0606e6440ac1'  '/data/abdo/docs'
        # annex
        homedir_init "annex"         
        git_config "$MR_REPO"  "annex.largefiles"    "include=* exclude=.gitignore exclude=.githooks/*"
        

[etc]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"         
        # remotes
        homedir_remote 'uni' 'ada'           '812ee084-0c83-48bb-aa3f-8bb5330b349f'  '/media/ada/home/abdo/etc'
        homedir_remote 'uni' 'galois'        '9013c2eb-ae38-471e-a622-e5186fffce34'  '/home/abdo/etc'
        homedir_remote 'uni' 'grothendieck'  '0c82fc81-3f53-411e-aeba-c2a8cc47ac62'  '/home/abdo/etc'
        homedir_remote 'uni' 'quasar'        'ff36195e-5c3b-4361-8d48-13a2afbd468f'  '/media/quasar/abdo/etc'
        homedir_remote 'uni' 'skynet'        '3956083b-69b5-4483-a285-a2616ac978e6'  '/data/abdo/etc'


[lib]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "git"
        # remotes
        homedir_remote 'git' 'ada'           'fa39533e-408b-4776-ac35-61797aa0a5dd'  '/media/ada/home/abdo/lib'
        homedir_remote 's3'  'babel'         '0d77482b-bfda-444a-b2af-672b043e275f'  'lib'
        homedir_remote 'git' 'galois'        '3ec2f57a-1886-4832-8e8f-3e3851e2b691'  '/home/abdo/lib'
        homedir_remote 'git' 'grothendieck'  '25c6a1f3-77f8-4b76-b978-10a75caf6fa1'  '/home/abdo/lib'        
        homedir_remote 'git' 'quasar'        'bf654989-f89a-45b3-a87a-445ba67477b0'  '/media/quasar/abdo/lib'
        homedir_remote 'git' 'skynet'        '3905813d-89b2-4cdd-b237-f1f0db22716b'  '/data/abdo/lib'
        # annex
        homedir_init "annex"
        git_config "$MR_REPO"  "annex.largefiles"    "include=* exclude=.gitignore exclude=.githooks/* exclude=*.opf exclude=*.json exclude=*.sql"
        

[mail]
checkout = homedir_checkout "galois" "grothendieck" "quasar" "skynet"

init = 
        # config
        homedir_perms "700"
        homedir_init "git" 
        touch "$MR_REPO/.git/.noindex"
        # remotes
        homedir_remote 'git' 'galois'        '7f342f70-8e2e-4559-817d-3fa6c39cdac1'  '/home/abdo/mail'
        homedir_remote 'git' 'grothendieck'  'dbae3bc8-5fce-4dde-8723-1b167ee2e739'  '/home/abdo/mail'
        homedir_remote 'git' 'quasar'        'e5cb4fed-8e79-47b1-bd71-e950fd95d923'  '/media/quasar/abdo/mail'
        homedir_remote 'git' 'skynet'        '1ed88d74-15e9-43a9-9da1-b4798de54f79'  '/data/abdo/mail'
        # annex
        homedir_init "annex"
        git_config "$MR_REPO"  "annex.largefiles"    "exclude=*"


[music]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "git"
        # remotes
        homedir_remote 'git' 'ada'           '0629b4b9-4f72-4863-9a5e-c9fd9e24eb67'  '/media/ada/home/abdo/music'
        homedir_remote 's3'  'babel'         '6deff244-dc63-434c-a6ef-bc326ed10db9'  'music'
        homedir_remote 'git' 'galois'        'b977eb03-4d1a-4c2f-ad83-2efb0f004f79'  '/home/abdo/music'
        homedir_remote 'git' 'grothendieck'  '30383c51-9b2c-4974-af7e-3bf129ef36a3'  '/home/abdo/music'
        homedir_remote 'git' 'quasar'        '889dbd2b-e7fb-46c2-8549-1fbe294efb48'  '/media/quasar/abdo/music'
        homedir_remote 'git' 'skynet'        'd31a66e4-65e3-4fb7-b9a6-0fed1bfa51e7'  '/data/abdo/music'
        # annex
        homedir_init "annex"
        git_config "$MR_REPO"  "annex.largefiles"    "include=* exclude=.gitignore exclude=.githooks/*"


[opt]
checkout = homedir_checkout "galois" "grothendieck" "quasar"

# we skip opt on galois, this way
skip = unison_skip "$MR_REPO" "$@" 

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        mkdir -p "$MR_REPO/p2p/Incomming"
        symlink_relative "$MR_REPO/tmp" "${MR_CONFIG%/*}/tmp"
        # remotes
        homedir_remote 'dir' 'galois'        'a6682645-3322-47e6-bf80-84e471f2589a'  '/home/abdo/opt'
        homedir_remote 'uni' 'grothendieck'  '05fdf4c8-f77c-4e2d-a24b-c980f370ed2b'  '/data/abdo/opt'
        homedir_remote 'uni' 'quasar'        '768a9746-22fd-4ae1-9ab9-ec0e0060220d'  '/media/quasar/abdo/opt'


[pics]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "git" 
        # remotes
        homedir_remote 'git' 'ada'           'a1fc9691-6bdf-41ef-ab71-2e506d003a25'  '/media/ada/home/abdo/pics'
        homedir_remote 's3'  'babel'         'd61dfbf1-50f8-44f2-9af8-1cb153672031'  'pics'
        homedir_remote 'git' 'galois'        'c3946f85-d2df-495c-8ed2-06264ef2bb71'  '/home/abdo/pics'
        homedir_remote 'git' 'grothendieck'  'ce5f927b-0ef9-40b9-a849-a9d9a6fa2f9f'  '/home/abdo/pics'
        homedir_remote 'git' 'quasar'        'de924d73-b6eb-40c3-8431-14c4086ca409'  '/media/quasar/abdo/pics'
        homedir_remote 'git' 'skynet'        '40c8cb9b-560c-4fd2-9285-24f2dbe92fef'  '/data/abdo/pics'
        # annex
        homedir_init "annex"
        git_config "$MR_REPO"  "annex.largefiles"    "include=* exclude=.gitignore exclude=.githooks/*"
        

[priv]
checkout = homedir_checkout "galois" "grothendieck" "skynet"

init =
        # config
        homedir_perms "700"
        # ecryptfs
        local localremote="$(homedir_remote_from_path "$MR_REPO")"
        if [[ "$localremote" =~ ^galois|grothendieck$ ]]; then
            homedir_ecryptfs_init
        fi
        homedir_init "uni"        
        # remotes
        homedir_remote 'uni' 'galois'        '136f7627-0bb2-4cac-a8ec-80c163a97db3'  '/home/abdo/priv'
        homedir_remote 'uni' 'grothendieck'  'c15a5b6b-8761-4f8c-ac6a-cb4d84e5396d'  '/home/abdo/priv'
        homedir_remote 'uni' 'skynet'        '8d54f6eb-f1f9-411c-a5c5-93708e7da245'  '/data/abdo/priv'
        # unison        
        unison_config "$MR_REPO" 'mountpoint' 'gnupg'
        unison_config "$MR_REPO" 'ignore' '^gnupg/S\.gpg-agent.*$'


[proj]
checkout = homedir_checkout "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        # remotes
        homedir_remote 'uni' 'galois'        'db06b395-b7ec-4c8e-85b3-9a6b768a0868'  '/home/abdo/proj'
        homedir_remote 'uni' 'grothendieck'  '3afb2b56-2d75-4bbc-925a-dbd4912aebf9'  '/home/abdo/proj'
        homedir_remote 'uni' 'quasar'        'e1e6d6d0-acb0-47e6-9028-e593680ed113'  '/media/quasar/abdo/proj'
        homedir_remote 'uni' 'skynet'        'e6f9c576-f93a-4e30-a2c5-87d3544d4140'  '/data/abdo/proj'


[repos]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quark" "quasar" "skynet"

init =
        # config
        homedir_perms "770"
        homedir_init "git"
        # remotes
        homedir_remote 'git' 'ada'           'db16811d-f446-470d-86ad-4898720add52'  '/media/ada/home/abdo/repos'
        homedir_remote 'git' 'galois'        'd5102a1c-496c-4ca5-901c-d2e22a5da879'  '/home/abdo/repos'
        homedir_remote 'git' 'grothendieck'  'd5e6cc8a-ceeb-4136-86bc-61d62aa69549'  '/home/abdo/repos'
        homedir_remote 'git' 'quark'         '6c90317a-cd8a-4cc4-849c-8f03776f5fa6'  '/home/abdo/repos'
        homedir_remote 'git' 'quasar'        'ecba2989-6394-495f-a0a4-5fcbaebcb1e9'  '/media/quasar/abdo/repos'
        homedir_remote 'git' 'skynet'        'e87b613a-2463-45b8-be20-403175118d5a'  '/data/abdo/repos'
        # annex
        homedir_init "annex"
        git_config "$MR_REPO"  "annex.largefiles"    "include=* exclude=.gitignore exclude=.githooks/* exclude=*.sig"
        

[sdk]
checkout = homedir_checkout "galois" "grothendieck" "quasar"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        # remotes
        homedir_remote 'uni' 'galois'        'aa918dd3-f6d7-4153-bcec-59cbd558ddcc'  '/data/abdo/sdk'
        homedir_remote 'uni' 'grothendieck'  'fbab88fd-0d4e-4966-bd91-5b065f2adac0'  '/data/abdo/sdk'
        homedir_remote 'uni' 'quasar'        '9bd7ff77-547b-4220-b888-23dc45a9332f'  '/media/quasar/abdo/sdk'


[share]
checkout = homedir_checkout "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        # remotes
        homedir_remote 'uni' 'galois'        'f735c54b-0d22-4bb0-b9b6-6ff021086bf5'  '/home/abdo/share'
        homedir_remote 'uni' 'grothendieck'  'ceccc49d-21f7-4b09-b5fe-db89dac2c393'  '/home/abdo/share'
        homedir_remote 'uni' 'quasar'        '22af68fe-186d-4c34-9170-12e901caa61b'  '/media/quasar/abdo/share'
        homedir_remote 'uni' 'skynet'        '2e95f2b7-78c5-447b-914a-5cf2928d3a59'  '/data/abdo/share'


[src]
checkout = homedir_checkout "galois" "grothendieck" "quasar"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        # remotes
        homedir_remote 'uni' 'galois'        '883bbfbb-d7ac-47ce-8733-f23086a01bfe'  '/data/abdo/src'
        homedir_remote 'uni' 'grothendieck'  '894bad59-7ed5-4d9a-a64b-992bbeab9238'  '/data/abdo/src'
        homedir_remote 'uni' 'quasar'        '9f16b8b4-f270-493c-8507-be4d9344b76e'  '/media/quasar/abdo/src'


[usr]
checkout = homedir_checkout "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        # remotes
        homedir_remote 'uni' 'galois'        '15c1b46a-498d-4cab-a8ff-8e2657630271'  '/home/abdo/usr'
        homedir_remote 'uni' 'grothendieck'  'a6eec9ab-4381-40b0-b346-265790278b80'  '/home/abdo/usr'
        homedir_remote 'uni' 'quasar'        'be036872-09ad-4169-9b08-da6ed7959be5'  '/media/quasar/abdo/usr'
        homedir_remote 'uni' 'skynet'        '21948f7e-003b-4bf4-9ef5-fe0183e0a60d'  '/data/abdo/usr'
        

[var]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quark" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        symlink_relative "$MR_REPO/desk" "${MR_CONFIG%/*}/desk"
        symlink_relative "$MR_REPO/down" "${MR_CONFIG%/*}/down"
        # remotes
        homedir_remote 'uni' 'ada'           '150f391d-6810-4c4e-ad98-66541ec33ba4'  '/media/ada/home/abdo/var'
        homedir_remote 'uni' 'galois'        '06a7a2d2-dbb8-4ef6-a046-6b40a0a3c8ee'  '/home/abdo/var'
        homedir_remote 'uni' 'grothendieck'  'bc5b156d-5d41-405b-9b9d-e93664f4aeb3'  '/home/abdo/var'
        homedir_remote 'uni' 'quark'         'dce4f873-82b8-4a03-ae03-776cdbecf887'  '/home/abdo/var'
        homedir_remote 'uni' 'quasar'        '67b0fc1d-f615-4aa4-9e21-9b09d065d099'  '/media/quasar/abdo/var'
        homedir_remote 'uni' 'skynet'        'cc95ef6b-4e30-4cbf-9087-546225c850a5'  '/data/abdo/var'
        # unison     
        unison_config "$MR_REPO" 'ignore' '^(down/Incomming|log|gmpc/gmpc.key|emacs)'


[vids]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "git"
        # remotes
        homedir_remote 'git' 'ada'           'efe2a014-12a1-4c2f-8458-1f678e348ad3'  '/media/ada/home/abdo/vids'
        homedir_remote 'git' 'galois'        'c672faf1-b693-4518-8df6-c618ad07a2fd'  '/home/abdo/vids'
        homedir_remote 'git' 'grothendieck'  '6016bfad-8746-4d52-8eac-de076dc9896f'  '/home/abdo/vids'
        homedir_remote 'git' 'quasar'        '914cdd81-7ab5-445f-a828-93b3d2528a11'  '/media/quasar/abdo/vids'
        homedir_remote 'git' 'skynet'        'f8f2ae2c-78e6-4760-8c00-8af76ab50ca6'  '/data/abdo/vids'
        # annex
        homedir_init "annex"
        git_config "$MR_REPO"  "annex.largefiles"    "include=* exclude=.gitignore exclude=.githooks/* exclude=bin/* exclude=etc/* exclude=*.srt"
        

[virt]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "git"
        mkdir -p "$MR_REPO/qemu"
        chattr +C "$MR_REPO/qemu"
        # remotes
        homedir_remote 'git' 'ada'           'cf205132-a46c-42d5-80fd-c346e1147555'  '/media/ada/home/abdo/virt'
        homedir_remote 'git' 'galois'        '37cd3186-a3e3-4360-b5fa-e249ce135f4e'  '/data/abdo/virt'     
        homedir_remote 'git' 'grothendieck'  '119a8cc0-3caa-4d40-8bb5-35a6d4c8ac4a'  '/data/abdo/virt'
        homedir_remote 'git' 'quasar'        '46b76baa-2dbd-4341-9869-4d4d09bc3fde'  '/media/quasar/abdo/virt'
        homedir_remote 'git' 'skynet'        '8f08f286-e86c-4a58-9d19-3e1f8dc1b806'  '/data/abdo/virt'     
        # annex
        homedir_init "annex"
        git_config "$MR_REPO"  "annex.largefiles"    "include=* exclude=.gitignore exclude=.githooks/* exclude=bin/* exclude=etc/* exclude=*.ini exclude=*.sh exclude=*.py exclude=*.reg exclude=*.txt exclude=*.md"


[work]
checkout = homedir_checkout "ada" "galois" "grothendieck" "quasar" "skynet"

init =
        # config
        homedir_perms "700"
        homedir_init "uni"
        # remotes
        homedir_remote 'uni' 'ada'           'c4acb385-b509-4196-98e0-69e25c0ac68d'  '/media/ada/home/abdo/work'
        homedir_remote 'uni' 'galois'        'f3f6a113-0f92-4dc9-9cab-e87926bcd36c'  '/home/abdo/work'
        homedir_remote 'uni' 'grothendieck'  '3e4765b4-2853-4add-a106-4b36cfc0332c'  '/home/abdo/work'
        homedir_remote 'uni' 'quasar'        '72bebd34-89c3-456b-b814-9d8eb6a45c59'  '/media/quasar/abdo/work'
        homedir_remote 'uni' 'skynet'        '5992ac9b-3474-4015-9928-75158960a9a8'  '/data/abdo/work'
        # unison
        unison_config  "$MR_REPO" 'mountpoint' 'papers'