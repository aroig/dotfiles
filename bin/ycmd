#!/usr/bin/bash

# Start ycmd in a systemd scope. stdin and stdout will still be attached and
# emacs will be happy launching this.

# TODO: ycmd actually sets up an http server. Try to make it socket activated!
# The difficulty is that emacs-ycmd tries to manage the daemon (checks for pid
# etc).
exec systemd-run --user --quiet         \
     --scope                            \
     --unit=emacs-ycmd                  \
     --slice=daemons.slice              \
     --property=Requires=emacs.service  \
     /usr/bin/python /usr/lib/ycmd/ycmd "$@"
